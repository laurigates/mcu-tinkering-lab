# Robot Configuration for Testing
# All optional subsystems disabled to prevent thread leaks and startup delays.
robot:
  name: "ESP32-RoboCar"
  description: "Dual ESP32 AI-powered autonomous robot car"

  # Physical dimensions (in meters)
  dimensions:
    length: 0.20
    width: 0.15
    height: 0.10
    wheelbase: 0.14
    track_width: 0.12
    wheel_radius: 0.035

  # Mass properties
  mass: 0.8  # kg (including battery)
  inertia: 0.01  # kg⋅m²

  # Motor specifications (TB6612FNG with DC motors)
  motors:
    left:
      pin_config:
        pwm: 23
        in1: 2
        in2: 4
      max_rpm: 200
      stall_torque: 0.5
      no_load_current: 0.1
      stall_current: 2.0
      resistance: 3.0
      inductance: 0.01
      back_emf_constant: 0.01

    right:
      pin_config:
        pwm: 13
        in1: 15
        in2: 12
      max_rpm: 200
      stall_torque: 0.5
      no_load_current: 0.1
      stall_current: 2.0
      resistance: 3.0
      inductance: 0.01
      back_emf_constant: 0.01

  # Servo configuration
  servos:
    camera_pan:
      pin: 25
      min_angle: -90
      max_angle: 90
      center_angle: 0

  # Sensor configuration
  sensors:
    camera:
      type: "OV2640"
      resolution: [640, 480]
      fps: 20
      field_of_view: 60
      position: [0.08, 0, 0.06]

    imu:
      type: "MPU6050"
      update_rate: 100
      noise:
        accelerometer: 0.01
        gyroscope: 0.001

    ultrasonic:
      type: "HC-SR04"
      max_range: 4.0
      min_range: 0.02
      beam_angle: 15
      update_rate: 10

  # Communication configuration
  communication:
    i2c:
      address_main: 0x42
      address_cam: 0x43
      frequency: 100000
      pins:
        sda: 15
        scl: 14

    wifi:
      ssid: "ESP32-RoboCar"
      password: "robocar123"

    uart:
      baudrate: 115200

# Simulation settings
simulation:
  timestep: 0.01  # seconds (100Hz)
  physics_engine: ""  # Disabled for pure kinematics tests (no Pymunk)
  visualization: "headless"

  # All optional subsystems disabled to prevent background threads
  camera:
    enabled: false
    resolution: [640, 480]
    fov_degrees: 60.0
    fps: 20
    noise_level: 0.02
    compression_quality: 85

  wifi:
    enabled: false
    auto_connect: false
    default_ssid: "ESP32-RoboCar"
    default_password: "robocar123"
    connection_stability_threshold: 30.0
    max_retry_attempts: 3
    retry_delay_ms: 5000
    power_save_mode: true

  ota:
    enabled: false
    simulate_download_speed: 50000
    verification_delay: 1.0
    failure_probability: 0.05
    partition_size: 1572864

  # Motor control configuration
  motor_control:
    enabled: true
    mode: "velocity"

    velocity_pid:
      kp: 15.0
      ki: 5.0
      kd: 0.5
      output_limit: 255.0
      integral_limit: 50.0
      derivative_filter: 0.1

    position_pid:
      kp: 1.5
      ki: 0.0
      kd: 0.05
      output_limit: 50.0
      integral_limit: 50.0
      derivative_filter: 0.2

    encoder:
      pulses_per_revolution: 600
      noise_std: 0.1
      velocity_filter: 0.8
      max_velocity_change: 500.0

    velocity_feedforward: 25.0

  # Environment
  environment:
    type: "indoor"
    size: [5.0, 5.0]
    obstacles:
      - type: "box"
        position: [2.0, 2.0]
        size: [0.5, 0.5]
      - type: "cylinder"
        position: [3.0, 1.0]
        radius: 0.3

  # Communication bridge
  bridge:
    type: "websocket"
    host: "localhost"
    port: 8765

# AI Backend Configuration
ai_backend:
  enabled: false
  type: "claude"
  api_key: ""
  model: "claude-3-sonnet-20240229"

  ollama:
    host: "localhost"
    port: 11434
    model: "llava"
